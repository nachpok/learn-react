import React from "react";
import { useDraggable } from "@dnd-kit/core";
import { Position } from "./ReactPdf";
interface DraggableSignatureProps {
  id: string;
  style?: React.CSSProperties;
  position: Position;
  svg: string;
}
//Todo - remove option
function DraggableSignature({
  id,
  style,
  position,
  svg,
}: DraggableSignatureProps) {
  const { attributes, listeners, setNodeRef, transform } = useDraggable({
    id: id.toString(),
  });

  const lastPosition = position?.x
    ? { x: position.x, y: position.y }
    : { x: 0, y: 0 };
  const transformStyle = transform
    ? {
        transform: `translate3d(${transform.x + lastPosition.x}px, ${
          transform.y + lastPosition.y
        }px, 0)`,
      }
    : {};

  const d =
    "M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z";

  //TEST
  //   // Parse the SVG string into a DOM
  //   const parser = new DOMParser();
  //   const svgDoc = parser.parseFromString(svg, "image/svg+xml");
  //   const svgElement = svgDoc.documentElement;

  //   // Extract the attributes and children
  //   const width = svgElement.getAttribute("width") || undefined;
  //   const height = svgElement.getAttribute("height") || undefined;
  //   const viewBox = svgElement.getAttribute("viewBox") || undefined;

  //   const paths = svgDoc.querySelectorAll("path");

  //   const pathsArr: string[] = [];
  //   paths.forEach((path) => {
  //     pathsArr.push(path.getAttribute("d") || "");
  //   });
  return (
    <div
      ref={setNodeRef}
      style={{ ...style, ...transformStyle }}
      {...listeners}
      {...attributes}
    >
      <div style={{ position: "relative", width: "48px", height: "48px" }}>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 16 16"
        >
          <path d={d} />
          {arrP.map((d, index) => (
            <path
              key={index}
              d={d}
              strokeWidth="1.125"
              stroke="black"
              fill="none"
              strokeLinecap="round"
            />
          ))}
        </svg>

        <div
          style={{
            position: "absolute",
            top: 0,
            left: 0,
            width: "100%",
            height: "100%",
          }}
        />
      </div>
    </div>
  );
}

export default DraggableSignature;

const arrP = [
  "M 341.333,56.333 C 338.940,62.407 338.333,62.000 335.333,67.667",
  "M 335.333,67.667 C 330.157,73.527 330.940,74.074 325.333,79.667",
  "M 325.333,79.667 C 319.789,88.053 319.157,87.527 313.333,95.667",
  "M 313.333,95.667 C 306.733,103.427 306.789,103.386 299.333,110.333",
  "M 299.333,110.333 C 291.853,117.755 291.733,117.427 283.333,123.667",
  "M 283.333,123.667 C 275.361,129.107 275.520,129.089 266.667,133.000",
  "M 266.667,133.000 C 253.063,140.165 253.028,139.107 238.667,143.667",
  "M 238.667,143.667 C 227.981,144.113 228.396,146.165 217.333,145.000",
  "M 217.333,145.000 C 208.024,146.450 207.981,145.779 198.667,147.000",
  "M 198.667,147.000 C 191.000,147.000 191.024,147.450 183.333,147.000",
  "M 183.333,147.000 C 176.882,149.427 178.667,147.000 174.000,147.000",
  "M 174.000,147.000 C 171.121,141.790 170.549,144.094 170.667,136.333",
  "M 170.667,136.333 C 170.501,129.426 170.121,129.790 172.000,123.000",
  "M 172.000,123.000 C 173.633,119.649 172.834,119.426 175.333,116.333",
  "M 175.333,116.333 C 179.328,105.897 180.299,106.649 185.333,97.000",
  "M 185.333,97.000 C 189.076,92.998 188.328,92.564 193.333,89.667",
  "M 193.333,89.667 C 197.082,87.452 196.743,86.998 200.667,85.000",
  "M 200.667,85.000 C 203.124,82.618 203.416,83.119 206.000,81.000",
  "M 206.000,81.000 C 208.590,79.722 208.457,79.618 211.333,79.000",
  "M 211.333,79.000 C 214.968,77.975 214.923,78.055 218.667,77.667",
  "M 218.667,77.667 C 223.000,77.667 222.968,77.308 227.333,77.667",
  "M 227.333,77.667 C 230.667,77.667 230.667,77.667 234.000,77.667",
  "M 234.000,77.667 C 239.410,76.221 238.667,77.667 243.333,77.667",
  "M 243.333,77.667 C 246.332,79.825 245.744,78.555 246.667,82.333",
  "M 246.667,82.333 C 246.134,85.266 246.999,84.825 244.667,87.667",
  "M 244.667,87.667 C 242.333,91.333 242.467,91.266 239.333,94.333",
  "M 239.333,94.333 C 236.056,97.075 236.333,97.333 232.667,99.667",
  "M 232.667,99.667 C 230.474,101.568 230.390,101.408 228.000,103.000",
  "M 228.000,103.000 C 223.930,104.871 224.141,105.234 220.000,107.000",
  "M 220.000,107.000 C 216.265,110.067 215.930,109.204 212.000,111.667",
  "M 212.000,111.667 C 208.028,112.583 208.265,113.067 204.000,113.000",
  "M 204.000,113.000 C 198.337,113.464 198.361,113.583 192.667,113.667",
  "M 192.667,113.667 C 189.000,113.667 189.004,113.798 185.333,113.667",
  "M 185.333,113.667 C 182.000,113.667 182.000,113.667 178.667,113.667",
  "M 178.667,113.667 C 176.000,113.667 176.000,113.667 173.333,113.667",
  "M 173.333,113.667 C 169.333,113.667 169.333,113.667 165.333,113.667",
  "M 165.333,113.667 C 161.333,113.667 161.333,113.667 157.333,113.667",
  "M 157.333,113.667 C 152.333,113.667 152.333,113.667 147.333,113.667",
  "M 147.333,113.667 C 141.000,113.667 141.000,113.667 134.667,113.667",
  "M 134.667,113.667 C 131.667,113.667 131.667,113.667 128.667,113.667",
  "M 128.667,113.667 C 125.000,113.667 125.000,113.667 121.333,113.667",
  "M 121.333,113.667 C 115.176,113.824 118.333,113.667 115.333,113.667",
  "M 115.333,113.667 C 118.657,113.139 115.509,113.491 122.000,113.000",
  "M 122.000,113.000 C 126.667,113.000 126.657,112.806 131.333,113.000",
  "M 131.333,113.000 C 137.333,113.000 137.333,113.000 143.333,113.000",
  "M 143.333,113.000 C 149.667,113.000 149.667,113.000 156.000,113.000",
  "M 156.000,113.000 C 164.667,113.000 164.667,113.000 173.333,113.000",
  "M 173.333,113.000 C 183.333,113.000 183.333,113.000 193.333,113.000",
  "M 193.333,113.000 C 202.000,113.000 202.000,113.000 210.667,113.000",
  "M 210.667,113.000 C 220.333,113.000 220.333,113.000 230.000,113.000",
  "M 230.000,113.000 C 239.000,113.000 239.000,113.000 248.000,113.000",
  "M 248.000,113.000 C 258.667,113.000 258.667,113.000 269.333,113.000",
  "M 269.333,113.000 C 276.000,113.000 276.000,113.000 282.667,113.000",
  "M 282.667,113.000 C 287.333,113.000 287.333,113.000 292.000,113.000",
  "M 292.000,113.000 C 297.333,113.000 297.333,113.000 302.667,113.000",
  "M 302.667,113.000 C 309.667,113.000 309.667,113.000 316.667,113.000",
  "M 316.667,113.000 C 322.000,113.000 322.000,113.000 327.333,113.000",
  "M 327.333,113.000 C 332.667,113.000 332.667,113.000 338.000,113.000",
  "M 338.000,113.000 C 343.000,113.000 343.000,113.000 348.000,113.000",
];
